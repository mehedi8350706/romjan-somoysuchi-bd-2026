<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ app_name }}</title>

<style>
body{
    margin:0;
    font-family:Poppins, sans-serif;
    color:white;
    text-align:center;
    background: url("{{ url_for('static', filename='images/salam.jpg') }}") no-repeat center center fixed;
    background-size: cover;
}

.container{
    padding:20px;
}

.top-line{
    font-size:22px;
    font-weight:bold;
}

.date{
    margin-top:5px;
    font-size:18px;
}

.row{
    display:flex;
    justify-content:space-between;
    padding:0 20px;
    margin-top:10px;
    font-weight:bold;
}

.card{
    background: rgba(0,0,0,0.55);
    margin:12px 20px;
    padding:15px;
    border-radius:12px;
    font-size:18px;
}

.active{
    border:2px solid gold;
    box-shadow:0 0 25px gold;
}

.count{
    font-size:15px;
    margin-top:5px;
    color:#FFD700;
}

.footer{
    margin-top:30px;
    opacity:0.85;
}
</style>
</head>
<body>

<div class="container">

    <!-- Division + District Center -->
    <div class="top-line">{{ division }} - {{ district }}</div>

    <!-- Date + Week -->
    <div class="date">{{ date_bn }}</div>
    <div>{{ week }}</div>

    <!-- Roza + Tarabi -->
    <div class="row">
        <div>ЁЯМЩ {{ roza }} рждржо рж░рзЛржЬрж╛</div>
        <div>ЁЯХМ {{ tarabi }} рждржо рждрж╛рж░рж╛ржмрзА</div>
    </div>

    <!-- Sehri + Iftar -->
    <div class="row">
        <div>
            ЁЯН╜я╕П ржЗржлрждрж╛рж░: <span id="iftar">{{ iftar }}</span>
            <div class="count" id="cd-iftar"></div>
        </div>
        <div>
            ЁЯМД рж╕рзЗрж╣рж░рж┐: <span id="sehri">{{ sehri }}</span>
            <div class="count" id="cd-sehri"></div>
        </div>
    </div>

    <!-- 5 Waqt Namaz -->
    <div class="card" id="fajar-card">
        ржлржЬрж░ (рзи рж╕рзБржирзНржиржд + рзи ржлрж░ржЬ)<br>
        <span id="fajar">{{ fajar_12 }}</span>
        <div class="count" id="cd-fajar"></div>
    </div>

    <div class="card" id="zohor-card">
        ржпрзЛрж╣рж░ (рзк рж╕рзБржирзНржиржд + рзк ржлрж░ржЬ + рзи рж╕рзБржирзНржиржд)<br>
        <span id="zohor">{{ zohor_12 }}</span>
        <div class="count" id="cd-zohor"></div>
    </div>

    <div class="card" id="asor-card">
        ржЖрж╕рж░ (рзк ржлрж░ржЬ)<br>
        <span id="asor">{{ asor_12 }}</span>
        <div class="count" id="cd-asor"></div>
    </div>

    <div class="card" id="magrib-card">
        ржорж╛ржЧрж░рж┐ржм (рзй ржлрж░ржЬ + рзи рж╕рзБржирзНржиржд)<br>
        <span id="magrib">{{ magrib_12 }}</span>
        <div class="count" id="cd-magrib"></div>
    </div>

    <div class="card" id="esha-card">
        ржПрж╢рж╛ (рзк ржлрж░ржЬ + рзи рж╕рзБржирзНржиржд + рзй ржмрж┐рждрж░ + рждрж╛рж░рж╛ржмрзА)<br>
        <span id="esha">{{ esha_12 }}</span>
        <div class="count" id="cd-esha"></div>
    </div>

    <div class="footer">
        Developed by Mehedi Hasan
    </div>

</div>

<script>
function parseTime(t){
    if(!t || t.includes("рж╕ржорзЯ") || t.includes("рж╢рзБрж░рзБ")) return null;
    let [time,p]=t.split(" ");
    if(!p) return null;
    let [h,m]=time.split(":").map(Number);
    if(p==="PM" && h!=12) h+=12;
    if(p==="AM" && h==12) h=0;
    return h*60+m;
}

function nowMin(){
    let d=new Date();
    return d.getHours()*60+d.getMinutes();
}

function highlight(){
    let n=nowMin();
    let f=parseTime(fajar.innerText);
    let z=parseTime(zohor.innerText);
    let a=parseTime(asor.innerText);
    let m=parseTime(magrib.innerText);
    let e=parseTime(esha.innerText);

    document.querySelectorAll(".card").forEach(c=>c.classList.remove("active"));

    // Your exact rule
    if(n>=e || n<f){
        esha-card.classList.add("active");
    }
    else if(n>=f && n<z){
        fajar-card.classList.add("active");
    }
    else if(n>=z && n<(16*60+15)){ // 4:15 PM
        zohor-card.classList.add("active");
    }
    else if(n>=(16*60+30) && n<m){ // 4:30 PM to Magrib
        asor-card.classList.add("active");
    }
    else if(n>=m && n<e){
        magrib-card.classList.add("active");
    }
}

function countdown(targetId, boxId){
    let t=parseTime(document.getElementById(targetId).innerText);
    if(!t) return;

    setInterval(()=>{
        let now=new Date();
        let target=new Date();
        target.setHours(Math.floor(t/60),t%60,0,0);
        if(target<=now) target.setDate(target.getDate()+1);

        let diff=target-now;
        let h=Math.floor(diff/1000/3600);
        let m=Math.floor((diff/1000%3600)/60);
        let s=Math.floor(diff/1000%60);

        document.getElementById(boxId).innerText=
        `тП│ ${h}ржШ ${m}ржорж┐ ${s}рж╕рзЗ ржмрж╛ржХрж┐`;
    },1000);
}

highlight();
setInterval(highlight,60000);

countdown("iftar","cd-iftar");
countdown("sehri","cd-sehri");
countdown("fajar","cd-fajar");
countdown("zohor","cd-zohor");
countdown("asor","cd-asor");
countdown("magrib","cd-magrib");
countdown("esha","cd-esha");
</script>

</body>
</html>
